<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
  <link rel="manifest" href="/assets/manifest.json" />

  <link href="/assets/tailwind-1.9.6.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css"
    integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    :root {
  --bg-main: #f4f6fb;
  --bg-secondary: #ffffff;
  --text-main: #22223b;
  --input-bg: #f7f7fa;
  --input-text: #22223b;
  --button-bg: #2563eb;
  --button-hover: #1e40af;
  --button-text: #fff;
  --card-bg: #e9ecef;
  --border-radius: 0.75rem;
  --shadow: 0 2px 8px rgba(44,62,80,0.08);
    }
    .dark-theme {
  --bg-main: #181a20;
  --bg-secondary: #23272f;
  --text-main: #e5e7eb;
  --input-bg: #23272f;
  --input-text: #e5e7eb;
  --button-bg: #2563eb;
  --button-hover: #1e40af;
  --button-text: #fff;
  --card-bg: #23272f;
  --border-radius: 0.75rem;
  --shadow: 0 2px 8px rgba(44,62,80,0.18);
  --trackpad-bg: #7a6a2f;
    }
    body {
  background: var(--bg-main);
  color: var(--text-main);
  font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
  transition: background 0.3s, color 0.3s;
  min-height: 100vh;
    }
    input, textarea, select {
      background: var(--input-bg) !important;
      color: var(--input-text) !important;
      border-color: #444 !important;
    }
    .form-label, .form-control, .top-items input {
      color: var(--input-text) !important;
    }
    .card, .op-buttons, .top-items {
  background: var(--card-bg);
  border-radius: var(--border-radius);
  box-shadow: var(--shadow);
  padding: 1rem;
  margin-bottom: 1rem;
    }
    button, .btn {
  background: var(--button-bg);
  color: var(--button-text);
  border: none;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow);
  font-weight: 500;
  letter-spacing: 0.01em;
  transition: background 0.2s, box-shadow 0.2s, transform 0.2s;
    }
    button:hover, .btn:hover {
  background: var(--button-hover);
  box-shadow: 0 6px 18px rgba(44,62,80,0.16);
  transform: translateY(-2px) scale(1.04);
    }
    .theme-toggle {
      background: var(--card-bg);
      color: var(--text-main);
      border: none;
      border-radius: 2rem;
      padding: 0.5rem 1.2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      cursor: pointer;
      font-size: 1.1rem;
      margin-bottom: 1rem;
      display: inline-block;
    }
  </style>
  <style>
    .op-buttons,
    .top-items {
      display: flex;
      flex-wrap: wrap;
      width: 100%;

    }

    .op-buttons button {
      width: 12rem;
      /* font-size: 2em; */

    }

    .top-items button {
      /* font-size: 2em; */
    }

    .top-items input {
      width: 100%;
      /* font-size: 2em; */
    }

    :root {
      font-size: clamp(1rem, 2vw, 2rem);
    }

    button {
      user-select: none;
    }

  </style>
</head>

<body class="dark-theme">
  <!-- ...existing code... -->
  <div
    class="hidden bg-red-600 shadow-lg mx-auto w-96 max-w-full text-sm pointer-events-auto bg-clip-padding rounded-lg block mb-3"
    id="alert" role="alert" aria-live="assertive" aria-atomic="true" data-mdb-autohide="false">

    <div class="p-3 bg-red-600 rounded-b-lg break-words text-white">
      WebSocket not connected
    </div>
  </div>
  <form id="form" method="get" onsubmit="return populateTimestamp()">
    <p class="form-label inline-block mb-2 text-gray-700 text-xl">Last command: <span id="last-command">%(cmd)s %(key)s</span></p>
    <div class="card w-full max-w-xl mb-4 text-center" id="favourite-section">
      <h2 class="text-2xl font-bold mb-2">Favourite Commands</h2>
      <div id="favourite-buttons" class="flex flex-wrap justify-center gap-2 mb-2"></div>
      <button type="button" class="btn px-4 py-2" onclick="addFavouriteCommand()">
        <i class="fa fa-star mr-2"></i>Add Last Command to Favourites
      </button>
    </div>
    <div class="top-items p-2">
      <input type="text" name="cmd" value="%(cmd)s" class="form-control
      block
      w-full
      px-4
      py-2
      text-xl
      font-normal
      text-gray-700
      bg-white bg-clip-padding
      border border-solid border-gray-300
      rounded
      transition
      ease-in-out
      m-0
      focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" />

      <input type="text" name="key" value="%(key)s" class="form-control mt-6
      block
      w-full
      px-4
      py-2
      text-xl
      font-normal
      text-gray-700
      bg-white bg-clip-padding
      border border-solid border-gray-300
      rounded
      transition
      ease-in-out
      m-0
      focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" />
      <input type="hidden" name="timestamp" value="" />
      <div class="flex justify-between w-full">
        <div>

          <button type="submit"
            class="inline-block px-6 py-2.5 bg-indigo-500  text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">submit</button>


          <button type="button"
            class="inline-block px-6 py-2.5 bg-indigo-500  text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out"
            onclick="sendClipboardData()">Send clipboard data</button>

        </div>

        <div class="flex items-center self-center">
          <label class="inline-block">Key relay</label>
          <input class="form-control border border-solid border-gray-300 text-xl" type="text"
            onkeyup="keyPressRelay(event)" placeholder="keys will be silently sent" autocapitalize="off" />
        </div>


      </div>
    </div>



    <br />
    <div class="op-buttons flex justify-around ">



  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickKey('alt+Tab')">
        <i class="fa fa-window-restore mr-2"></i> alt+Tab
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickKey('ctrl+F4')">
        <i class="fa fa-times-circle mr-2"></i> ctrl+F4
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickKey('alt+F4')">
        <i class="fa fa-power-off mr-2"></i> alt+F4
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="mouseHoldFor3Sec()">
        <i class="fa fa-mouse-pointer mr-2"></i> Left Click Down for 3 sec
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickMouse(' 0 0 click 3')">
        <i class="fa fa-mouse mr-2"></i> Right Click
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickSetCmd('key')">
        <i class="fa fa-keyboard mr-2"></i> key cmd
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickSetCmd('type')">
        <i class="fa fa-i-cursor mr-2"></i> type cmd
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickKey('--clearmodifiers XF86AudioMute')">
        <i class="fa fa-volume-mute mr-2"></i> Mute
      </button>
  <button type="button" class="bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-6 px-4 w-48 h-20 rounded shadow-xl active:shadow-lg" onClick="btnClickKey('Return')">
        <i class="fa fa-sign-in-alt mr-2"></i> enter
      </button>




    </div>
    <div class="flex justify-around ">



      <button type="button" class="w-24 h-24 rounded-full bg-blue-500 focus:outline-none shadow-xl active:shadow-lg"
        onClick="btnClickKey('--clearmodifiers XF86AudioPlay')">
        <i class="fa fa-play fa-2x text-white"></i>
      </button>
      <button type="button" class="w-24 h-24 rounded-full bg-blue-500 focus:outline-none shadow-xl active:shadow-lg"
        onClick="btnClickKey('--clearmodifiers XF86AudioStop')">
        <i class="fa fa-stop fa-2x text-white"></i>
      </button>
      <button type="button" class="w-24 h-24 rounded-full bg-blue-500 focus:outline-none shadow-xl active:shadow-lg"
        onClick="btnClickKey('--clearmodifiers XF86AudioPrev')">
        <i class="fa fa-backward-step fa-2x text-white"></i>
      </button>
      <button type="button" class="w-24 h-24 rounded-full bg-blue-500 focus:outline-none shadow-xl active:shadow-lg"
        onClick="btnClickKey('--clearmodifiers XF86AudioNext')">
        <i class="fa fa-forward-step fa-2x text-white"></i>
      </button>

    </div>

    <br />
    <track-pad></track-pad>
    <br />
    <div class="flex justify-around ">


      <button class="bg-teal-800 focus:outline-none text-white text-3xl p-3 px-8 shadow-xl active:shadow-lg"
        onmousedown="starttimer(event,' 0 0 click 4')" onmouseleave="stoptimer()" onmouseup="stoptimer()"
        ontouchstart="starttimer(event,' 0 0 click 4')" ontouchend="stoptimer()">
        <i class="fa fa-arrow-up-long fa-1x text-white mr-2"></i> Scroll
      </button>
      <button
        class="bg-blue-800 focus:outline-none text-white text-3xl p-3 px-8 w-1/6 rounded-full shadow-xl active:shadow-lg"
        onmousedown="starttimer(event,'--clearmodifiers XF86AudioRaiseVolume', btnClickKey)" onmouseleave="stoptimer()"
        onmouseup="stoptimer()" ontouchstart="starttimer(event,'--clearmodifiers XF86AudioRaiseVolume', btnClickKey)"
        ontouchend="stoptimer()">
        <i class="fa fa-volume-up fa-1x text-white mr-2"></i> Vol+
      </button>
    </div>
    <div class="flex justify-around ">


      <button class="bg-teal-800 focus:outline-none text-white text-3xl p-3 px-8 shadow-xl active:shadow-lg"
        onmousedown="starttimer(event,' 0 0 click 5')" onmouseleave="stoptimer()" onmouseup="stoptimer()"
        ontouchstart="starttimer(event,' 0 0 click 5')" ontouchend="stoptimer()">
        <i class="fa fa-arrow-down-long fa-1x text-white mr-2"></i> Scroll
      </button>
      <button
        class="bg-blue-800 focus:outline-none text-white text-3xl p-3 px-8 w-1/6 rounded-full shadow-xl active:shadow-lg"
        onmousedown="starttimer(event,'--clearmodifiers XF86AudioLowerVolume', btnClickKey)" onmouseleave="stoptimer()"
        onmouseup="stoptimer()" ontouchstart="starttimer(event,'--clearmodifiers XF86AudioLowerVolume', btnClickKey)"
        ontouchend="stoptimer()">
        <i class="fa fa-volume-down fa-1x text-white mr-2"></i> Vol-
      </button>
    </div>


    <br />
    <div style="display:grid; grid-template-columns:auto auto auto">
      <button style="grid-column:1/2"
        class=" h-24 bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onClick="btnClickKey('Escape')">
        <i class="fa fa-sign-out-alt mr-2"></i> Escape
      </button>
      <button style="grid-column:2/3"
        class="h-24 bg-blue-800 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onmousedown="starttimer(event,'Up', btnClickKey)" onmouseleave="stoptimer()"
        onmouseup="stoptimer()" ontouchstart="starttimer(event,'Up', btnClickKey)" ontouchend="stoptimer()">
        <i class="fa fa-arrow-up mr-2"></i> up
      </button>
      <button style="grid-column:3/4"
        class=" h-24 bg-yellow-800 hover:bg-yellow-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onClick="btnClickKey('KP_Space')">
        <i class="fa fa-space-shuttle mr-2"></i> Space
      </button>
      <button style="grid-column:1/2"
        class="h-24 bg-blue-800 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onmousedown="starttimer(event,'Left', btnClickKey)" onmouseleave="stoptimer()"
        onmouseup="stoptimer()" ontouchstart="starttimer(event,'Left', btnClickKey)" ontouchend="stoptimer()">
        <i class="fa fa-arrow-left mr-2"></i> left
      </button>

      <button style="grid-column:2/3"
        class="h-24 bg-blue-800 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onClick="btnClickKey('Return')">
        <i class="fa fa-sign-in-alt mr-2"></i> enter
      </button>
      <button style="grid-column:3/4"
        class="h-24 bg-blue-800 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onmousedown="starttimer(event,'Right', btnClickKey)" onmouseleave="stoptimer()"
        onmouseup="stoptimer()" ontouchstart="starttimer(event,'Right', btnClickKey)" ontouchend="stoptimer()">
        <i class="fa fa-arrow-right mr-2"></i> right
      </button>
      <button style="grid-column:2/3"
        class="h-24 bg-blue-800 hover:bg-blue-700 text-white font-bold py-4 px-4 rounded shadow-xl active:shadow-lg"
        type="button" onmousedown="starttimer(event,'Down', btnClickKey)" onmouseleave="stoptimer()"
        onmouseup="stoptimer()" ontouchstart="starttimer(event,'Down', btnClickKey)" ontouchend="stoptimer()">
        <i class="fa fa-arrow-down mr-2"></i> down
      </button>
    </div>
  </form>



  <script>
    // Favourite commands logic
    function addFavouriteCommand() {
      const lastCmdText = document.getElementById('last-command').textContent.trim();
      if (!lastCmdText) return;
      let favourites = JSON.parse(localStorage.getItem('favouriteCommands') || '[]');
      if (!favourites.includes(lastCmdText)) {
        favourites.push(lastCmdText);
        localStorage.setItem('favouriteCommands', JSON.stringify(favourites));
        renderFavouriteButtons();
      }
    }

    function renderFavouriteButtons() {
      const container = document.getElementById('favourite-buttons');
      container.innerHTML = '';
      let favourites = JSON.parse(localStorage.getItem('favouriteCommands') || '[]');
      favourites.forEach((cmd, idx) => {
        const btn = document.createElement('button');
        btn.className = 'btn px-4 py-2 flex items-center gap-2';
        btn.innerHTML = `<i class='fa fa-bolt'></i> ${cmd}`;
        btn.onclick = function() {
          const parts = cmd.split(' ');
          const cmdVal = parts[0] || '';
          const keyVal = parts.slice(1).join(' ') || '';
          form.cmd.value = cmdVal;
          form.key.value = keyVal;
          populateTimestamp();
          form.submit();
        };
        container.appendChild(btn);
      });
    }

    // Render on load
    window.addEventListener('DOMContentLoaded', renderFavouriteButtons);
    function toggleTheme() {
      const body = document.body;
      const label = document.getElementById('theme-label');
      if (body.classList.contains('dark-theme')) {
        body.classList.remove('dark-theme');
        label.textContent = 'Dark';
        localStorage.setItem('theme', 'light');
      } else {
        body.classList.add('dark-theme');
        label.textContent = 'Light';
        localStorage.setItem('theme', 'dark');
      }
    }
    // On load, set theme from localStorage
    window.onload = function() {
      if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-theme');
        document.getElementById('theme-label').textContent = 'Light';
      }
    }
    function toHex(d) {
      return "0x" + ("0" + (Number(d).toString(16))).slice(-2).toUpperCase()
    }
    var specialChars = ["{","}","[","]","|","_","â‚¹", ":", ";", "?", "~", "&", `"`, `'`, "!", "@", "#", "$", "%", "^", "*", "(", ")", "-", "+", "=", ",", ".", "/", "\\", "<", ">"]
    function keyPressRelay(e) {
      e.preventDefault();
      var key = e.key
      if (e.keyCode === 229) {
        key = e.target.value || "BackSpace"
        key = key === " " ? "space" : key
        if (specialChars.includes(key)) {
          key = toHex(key.codePointAt(0))
        }
      } else if (e.keyCode === 8) {
        key = "BackSpace"
      } else if (e.keyCode === 13) {
        key = "Return"
      }

      // alert(`key:${e.key} , which: ${e.which}, keyCode: ${e.keyCode} , code: ${e.code}, value: "${e.target.value}" , ckey: ${key}`)
      key = key === "Backspace" ? "BackSpace" : key
      key = key === " " ? "space" : key
      // console.log("keyPressRelay",e.code,e.key, key)

      btnClickKey(key)
      e.target.value = ""
    }
  </script>

  <script>
    let timerId;
    let afterNumberOfTimers = 10;
    let counter = 0;
    function starttimer(e, cmd, fn = btnClickMouse) {
      if (e) {
        e.preventDefault()
      }

      if (counter == 0) {
        console.log("run cmd", cmd)
        fn(cmd)
      }
      counter++;
      if (counter == afterNumberOfTimers) {
        counter = 0;
      }

      timerId = requestAnimationFrame(() => { starttimer(null, cmd, fn) })
    }
    function stoptimer() {
      cancelAnimationFrame(timerId)
    }
  </script>

  <script>
    var form = document.getElementById("form");

    function populateTimestamp() {
      if (window.websoc) {
        window.websoc.send(`${form.cmd.value} ${form.key.value}`)
        return false;
      }
      form.timestamp.value =
        new Date().getTime() - new Date().getTimezoneOffset() * 60 * 1000;
      console.log("form.timestamp.value", form.timestamp.value);
      return true;
    }

    function mouseHoldFor3Sec(value){
      btnClickKey(" mousedown 1")
      setTimeout(function(){
        btnClickKey(" mouseup 1")
      },3000)
    }
    function btnClickKey(value) {
      if (window.websoc) {
        window.websoc.send(`key ${value}`)
        return;
      }
      form.cmd.value = "key";
      form.key.value = value;

      populateTimestamp();
      form.submit();
    }

    function btnClickMouse(value) {
      if (window.websoc) {
        console.log("value", value)
        window.websoc.send(`mousemove_relative --sync ${value}`)
        return;
      }

      form.cmd.value = "mousemove_relative --sync ";
      form.key.value = value;

      populateTimestamp();
      form.submit();
    }

    function btnClickSetCmd(cmd) {
      form.cmd.value = cmd;
      form.key.value = "";
      form.key.focus();
    }
  </script>
  <style>
    button {
      min-height: 70px;
      min-width: 100px;
      margin: 10px;
    }
  </style>

  <script>
    function createFromData(cmd, key) {
      populateTimestamp();
      form.cmd.value = cmd;
      form.key.value = key;
      document.getElementById("last-command").innerHTML = `${cmd ? cmd : ""} ${key ? key : ""}`;
      var formData = new FormData(form);
      //formData.append("cmd", cmd);
      //formData.append("key", key);
      return formData;
    }

    function sendFormData(formData) {
      const data = [...formData.entries()];
      const asString = data
        .map(
          (x) => `${encodeURIComponent(x[0])}=${encodeURIComponent(x[1])}`
        )
        .join("&");
      console.log(asString);
      fetch("/?" + asString, {
        method: "GET",
      });
    }

    var trackPadElement = document.getElementsByTagName("track-pad")[0];
    trackPadElement.deltaCallBack = (delta) => {
      console.log("delta", delta);
      var xValue = delta.x < 0 ? "-- " + delta.x : delta.x;
      xValue = delta.x;
      if (window.websoc) {
        window.websoc.send(`mousemove_relative --sync ${xValue} ${delta.y}`)
        return;
      }
      sendFormData(
        createFromData("mousemove_relative --sync ", `${xValue} ${delta.y}`)
      );
    };
    trackPadElement.leftClickCallBack = (touchPoint) => {
      console.log("left click - touchPoint", touchPoint);
      if (window.websoc) {
        window.websoc.send(`mousemove_relative --sync 0 0 click 1`)
        return;
      }
      sendFormData(
        createFromData("mousemove_relative --sync ", ` 0 0 click 1`)
      );
    };

    trackPadElement.rightClickCallBack = (touchPoint) => {
      console.log("right click - touchPoint", touchPoint);
      if (window.websoc) {
        window.websoc.send(`mousemove_relative --sync 0 0 click 3`)
        return;
      }
      sendFormData(
        createFromData("mousemove_relative --sync ", ` 0 0 click 3`)
      );
    };
    class Trackpad extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.render();
      }

      render() {
        const div = document.createElement("div");
  div.style.width = "100%";
  div.style.height = "500px";
  // Use CSS variable for trackpad background
  div.style.backgroundColor = getComputedStyle(document.body).getPropertyValue('--trackpad-bg') || "beige";
  div.ontouchmove = this.handleTouchMove;
  div.ontouchstart = this.handleTouchStart;
  div.ontouchend = this.handleTouchEnd;
  this.appendChild(div);

        //this.innerHTML = `<h1>Hello, World!</h1>`;
      }
      start = {
        x: 0,
        y: 0,
      };
      move = {
        x: 0,
        y: 0,
      };
      handleTouchStart = (event) => {
        event.preventDefault();
        this.start.x = event.touches[0].pageX;
        this.start.y = event.touches[0].pageY;
        this.move = {
          x: 0,
          y: 0,
        };
      };

      handleTouchEnd = (event) => {
        event.preventDefault();
        this.move = {
          x: 0,
          y: 0,
        };
        window.touch = "end";

        if (event.touches.length > 0) {
          this.rightClickCallBack(this.start);
        } else if (
          this.start.x == event.changedTouches[0].pageX &&
          this.start.y == event.changedTouches[0].pageY
        ) {
          this.leftClickCallBack(this.move);
        }
      };

      handleTouchMove = (event) => {
        event.preventDefault();
        window.touch = "move";
        var firstTouch = event.changedTouches[0];
        var endX = firstTouch.pageX;
        var endY = firstTouch.pageY;
        var lastMove = this.move;
        var max = Math.max(
          Math.abs(endX - lastMove.x),
          Math.abs(endY - lastMove.y)
        );

        if (max > 1 && (lastMove.x != 0 || lastMove.y !== 0)) {
          this.deltaCallBack({
            x: endX - lastMove.x,
            y: endY - lastMove.y,
          });
        }
        this.move = {
          x: endX,
          y: endY,
        };
      };
    }

    customElements.define("track-pad", Trackpad);
  </script>

  <script>
    function sendClipboardData() {
      try {
        navigator.clipboard.readText().then(function (data) {
          console.log("Copied String ", data);
          sendFormData(createFromData(data, ""));
        }).catch((e) => {
          alert(e.message)
        });

      } catch (e) {
        alert(e.message)
      }
    }

  </script>

  <script>
    let alertDiv = document.getElementById("alert");
    function connectToWebSocket() {
      // alertDiv.style.display = "block"
      if (window.websoc) return;
      let socket = new WebSocket(`wss://${location.hostname}:8765`);

      socket.onopen = function (e) {
        console.log("Web socket connected");
        //  alert("web socket connected");
        alertDiv.style.display = "none"
        window.websoc = socket;
      };
      socket.onmessage = function (event) {
        console.log(`[message] Data received from server: ${event.data}`);
      };

      socket.onclose = function (event) {
        window.websoc = null;
        if (event.wasClean) {
          alertDiv.style.display = "block"
          // alert(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`);
        } else {
          // e.g. server process killed or network down
          // event.code is usually 1006 in this case
          // alert('[close] Connection died');
          alertDiv.style.display = "block"
        }
      };

      socket.onerror = function (error) {
        alertDiv.style.display = "block"
        // alert(`[error] ${error.message}`);
      };
    }
    connectToWebSocket();
    window.addEventListener("visibilitychange", function (event) {
      connectToWebSocket();
    }, false);
  </script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", function () {
        navigator.serviceWorker
          .register("/assets/serviceWorker.js")
          .then(res => console.log("service worker registered"))
          .catch(err => console.log("service worker not registered", err))
      })
    }
  </script>


  <div class="w-full flex justify-center p-4 mt-8">
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark/light mode">
      <i class="fa fa-moon"></i> <span id="theme-label">Dark</span> Mode
    </button>
  </div>
  <section class="w-full flex flex-col items-center p-4 mt-2">
    <div class="card w-full max-w-xl mb-4 text-center">
      <h2 class="text-2xl font-bold mb-2">Static Files</h2>
      <a href="/fileserve" target="_blank" class="text-indigo-500 underline">Browse Static Files</a>
    </div>
    <div class="card w-full max-w-xl text-center">
      <h2 class="text-2xl font-bold mb-2">Upload File</h2>
      <form target="_blank" enctype="multipart/form-data" action="/fileupload" method="post">
        <label class="block mb-2 font-medium">Choose file to upload:</label>
        <input type="file" name="file" class="form-control mb-4" />
        <input type="submit" value="Upload" class="btn px-6 py-2.5" />
      </form>
    </div>
  </section>

</body>



</html>